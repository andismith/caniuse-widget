// author: andi smith
// website: www.andismith.com
// version: 0.1

function canIUseDataLoaded(e){canIUse.dataLoaded(e)}var canIUse=function(){function b(e){e=e.toLowerCase();if(m.query){return m.query.results.json.data[e]}else if(m.data){return m.data[e]}else{return null}}function w(e){var t={y:"Yes",x:"With Prefix",n:"No",a:"Partial Support",p:"Polyfill",u:"Unknown"};return t[e]}function E(e){var t={rec:"W3C Recommendation",pr:"W3C Proposed Recommendation",cr:"W3C Candidate Recommendation",wd:"W3C Working Draft",other:"Non-W3C, but Reputable",unoff:"Unofficial or W3C 'Note'"};return t[e]||"Unknown"}function S(e,t){var n={version:-1,prefixed:false},r=-1;for(var i in t){if(t.hasOwnProperty(i)&&t[i].indexOf(e)>-1){r=parseFloat(i.split("-")[0]);if(n.version===-1||n.version>r){n.version=r;n.prefixed=t[i].indexOf("x")>-1}}}return n}function x(e){var t=["y","a","p"],n={};for(var r=0;r<t.length;r++){n=S(t[r],e);if(n.version!==-1){return{result:t[r],prefixed:n.prefixed,version:n.version!=="0"?n.version:"0"}}}return{result:"n",prefixed:false,version:"No"}}function T(e){var t={},n={},i="",s={};t=m.agents||m.query.results.json.agents;n.title=e.title;n.code=e;n.status=E(e.status);n.agents=[];for(var o=0,u=r.length;o<u;o++){i=r[o];if(t[i]){s=x(e.stats[r[o]]);n.agents.push({browsercode:i,prefixed:s.prefixed,supportcode:s.result,support:w(s.result),title:t[i].browser,type:t[i].type.toLowerCase(),version:s.version})}}return n}function N(e){var t="",n="",r="",d="",v=false,m={},g=0,y=0;n=i.replace("{title}",e.title);n+=s.replace("{status}",e.status);n+=o;for(g=0,y=e.agents.length;g<y;g++){m=e.agents[g];if(m.prefixed){v=true}t=l.replace(/\{browsercode\}/g,m.browsercode).replace(/\{prefixed\}/g,m.prefixed===true?"*":"").replace(/\{supportcode\}/g,m.supportcode).replace(/\{support\}/g,m.support).replace(/\{browser\}/g,m.title).replace(/\{version\}/g,m.version);if(m.type==="desktop"){r+=t}else if(m.type==="mobile"){d+=t}}if(r!==""){n+=u;n+=f.replace(/\{items\}/g,r)}if(d!==""){n+=a;n+=f.replace(/\{items\}/g,d)}if(v){n+=c}n+=h;n+=p.replace(/\{feature\}/g,e.featureCode);return n}function C(e){var t=[],n,r="",i={},s={},o=0,u=0;if(typeof e==="undefined"){t=document.querySelectorAll(".caniuse")}else{t.push(document.getElementById(e))}u=t.length;for(o=0;o<u;o++){n=t[o];r=n.getAttribute("data-feature")||"unknown";i=b(r);if(i){s=T(i);s.featureCode=r;n.innerHTML=N(s)}else{n.innerHTML=v.replace(/\{feature\}/g,r)}}}function k(e){var t=[],n,r=0,i=0;if(typeof e==="undefined"){t=document.querySelectorAll(".caniuse")}else{t.push(document.getElementById(e))}i=t.length;for(r=0;r<i;r++){n=t[r];n.innerHTML=d}}function L(t,n){var r="",i=document.createElement("SCRIPT");r="http://query.yahooapis.com/v1/public/yql?q="+"select * from json where url = '"+e+"'"+"&format=json&jsonCompat=new&callback=canIUseDataLoaded";g=t;y=n;i.src=r;document.body.appendChild(i)}function A(e){if(typeof m==="undefined"){k(e);L(e,true)}else{C(e)}}var e="https://raw.github.com/Fyrd/caniuse/master/data.json";var t=true,n=true;var r=["chrome","firefox","ie","opera","safari","ios_saf","android","op_mob","and_chr","and_ff"];var i="<h1>{title}</h1>",s='<p class="status">{status}</p>',o="<p>Supported from the following versions:</p>",u="<h2>Desktop</h2>",a="<h2>Mobile / Tablet</h2>",f='<ul class="agents">{items}</ul>',l='<li title="{browser} - {support}" class="icon-{browsercode} {supportcode}"><span class="version">{version}{prefixed}</span></li>',c="<p>* denotes prefix required.</p>",h='<ul class="legend"><li>Supported:</li><li class="y">Yes</li><li class="n">No</li><li class="a">Partially</li><li class="p">Polyfill</li></ul>',p='<p class="stats">Stats from <a href="http://caniuse.com/#feat={feature}" target="_blank">caniuse.com</a></p>',d="<h1>Loading</h1>",v='<h1>Error</h1><p>Feature "{feature}" not found!</p>';var m,g,y;return{render:A,dataLoaded:function(e){m=e;if(y){C(g)}},init:function(){if(t){A()}else if(n){L(undefined,false)}}()}}()